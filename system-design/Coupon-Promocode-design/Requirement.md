Design a generic coupon/promocode system.

Coupon can give minimum Z% off upto X amount (with or without min cart size)
Coupon can give flat discount of X (with or without min cart size)
Coupon can be applicable for one/few/all customers
Coupon can be applicable on one/few/all merchants
Coupon can be used only one time/few time/everytime.